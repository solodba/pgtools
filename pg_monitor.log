
pgmetrics run at: 8 Aug 2024 10:36:19 AM (1 second ago)

PostgreSQL Cluster:
    Name:                
    Server Version:      13.10
    Server Started:      8 Aug 2024 10:29:19 AM (7 minutes ago)
    System Identifier:   7399907417988222830
    Timeline:            1
    Last Checkpoint:     8 Aug 2024 10:34:19 AM (2 minutes ago)
    REDO LSN:            0/90000D8
    Checkpoint LSN:      0/9000110 (56 B since REDO)
    Transaction IDs:     oldest = 478, next = 545, range = 67
    Notification Queue:  0.0% used
    Active Backends:     1 (max 1000)
    Recovery Mode?       no

System Information:
    Hostname:            pg01
    CPU Cores:           2 x 13th Gen Intel(R) Core(TM) i7-13700KF
    Load Average:        0.00
    Memory:              used=158 MiB, free=3.0 GiB, buff=2.0 MiB, cache=464 MiB
    Swap:                used=0 B, free=2.0 GiB
    +---------------------------------+-------------------+
    |                         Setting |             Value |
    +---------------------------------+-------------------+
    |                  shared_buffers |  120576 (942 MiB) |
    |                        work_mem |    40960 (40 MiB) |
    |            maintenance_work_mem |    65536 (64 MiB) |
    |                    temp_buffers |     8192 (64 MiB) |
    |             autovacuum_work_mem |                -1 |
    |                 temp_file_limit | 67108864 (64 GiB) |
    |            max_worker_processes |                32 |
    |          autovacuum_max_workers |                 8 |
    | max_parallel_workers_per_gather |                 4 |
    |        effective_io_concurrency |                 1 |
    +---------------------------------+-------------------+

WAL Files:
    WAL Archiving?       yes
    WAL Files:           9
    Ready Files:         0
    Archive Rate:        0.00 per min
    Last Archived:       8 Aug 2024 10:29:19 AM (7 minutes ago)
    Last Failure:        
    Totals:              8 succeeded, 0 failed
    Totals Since:        6 Aug 2024 2:20:08 PM (1 day ago)
    +--------------------+----------------+
    |            Setting |          Value |
    +--------------------+----------------+
    |          wal_level |        replica |
    |    archive_timeout |              0 |
    |    wal_compression |             on |
    |       max_wal_size | 4096 (4.0 GiB) |
    |       min_wal_size |  320 (320 MiB) |
    | checkpoint_timeout |            300 |
    |   full_page_writes |             on |
    |      wal_keep_size | 32768 (32 GiB) |
    +--------------------+----------------+

BG Writer:
    Checkpoint Rate:     0.08 per min
    Average Write:       19 KiB per checkpoint
    Total Checkpoints:   198 sched (99.0%) + 2 req (1.0%) = 200
    Total Write:         4.8 MiB, @ 31 B per sec
    Buffers Allocated:   1705 (13 MiB)
    Buffers Written:     466 chkpt (75.2%) + 0 bgw (0.0%) + 154 be (24.8%)
    Clean Scan Stops:    0
    BE fsyncs:           0
    Counts Since:        6 Aug 2024 2:20:07 PM (1 day ago)
    +------------------------------+--------------+
    |                      Setting |        Value |
    +------------------------------+--------------+
    |               bgwriter_delay |      20 msec |
    |         bgwriter_flush_after | 64 (512 KiB) |
    |        bgwriter_lru_maxpages |          400 |
    |      bgwriter_lru_multiplier |            2 |
    |                   block_size |         8192 |
    |           checkpoint_timeout |      300 sec |
    | checkpoint_completion_target |          0.9 |
    +------------------------------+--------------+

Backends:
    Total Backends:      1 (0.1% of max 1000)
    Problematic:         0 waiting on locks, 0 waiting on other, 0 xact too long, 0 idle in xact

Locks:
    +------------+-------------+-------+
    |  Lock Type | Not Granted | Total |
    +------------+-------------+-------+
    |   relation |           0 |     4 |
    | virtualxid |           0 |     1 |
    +------------+-------------+-------+
    |            |           0 |     5 |
    +------------+-------------+-------+

Vacuum Progress:
    No manual or auto vacuum jobs in progress.
    +------------------------------+----------------+
    |                      Setting |          Value |
    +------------------------------+----------------+
    |         maintenance_work_mem | 65536 (64 MiB) |
    |                   autovacuum |             on |
    | autovacuum_analyze_threshold |           1000 |
    |  autovacuum_vacuum_threshold |           5000 |
    |    autovacuum_freeze_max_age |      200000000 |
    |       autovacuum_max_workers |              8 |
    |           autovacuum_naptime |      21600 sec |
    |        vacuum_freeze_min_age |       50000000 |
    |      vacuum_freeze_table_age |      150000000 |
    +------------------------------+----------------+

Roles:
    +---------------------------+-------+------+-------+-----------+----------+------------+---------+---------+--------------------------------------------------------------+
    |                      Name | Login | Repl | Super | Creat Rol | Creat DB | Bypass RLS | Inherit | Expires |                                                    Member Of |
    +---------------------------+-------+------+-------+-----------+----------+------------+---------+---------+--------------------------------------------------------------+
    |                  postgres |   yes |  yes |   yes |       yes |      yes |        yes |     yes |         |                                                              |
    |                pg_monitor |       |      |       |           |          |            |     yes |         | pg_read_all_settings, pg_read_all_stats, pg_stat_scan_tables |
    |      pg_read_all_settings |       |      |       |           |          |            |     yes |         |                                                              |
    |         pg_read_all_stats |       |      |       |           |          |            |     yes |         |                                                              |
    |       pg_stat_scan_tables |       |      |       |           |          |            |     yes |         |                                                              |
    |         pg_signal_backend |       |      |       |           |          |            |     yes |         |                                                              |
    |      pg_read_server_files |       |      |       |           |          |            |     yes |         |                                                              |
    |     pg_write_server_files |       |      |       |           |          |            |     yes |         |                                                              |
    | pg_execute_server_program |       |      |       |           |          |            |     yes |         |                                                              |
    +---------------------------+-------+------+-------+-----------+----------+------------+---------+---------+--------------------------------------------------------------+

Tablespaces:
    +------------+----------+-------------------------------+---------+---------------------------+---------------------------+
    |       Name |    Owner |                      Location |    Size |                 Disk Used |                Inode Used |
    +------------+----------+-------------------------------+---------+---------------------------+---------------------------+
    | pg_default | postgres | $PGDATA = /data/postgres/data |  30 MiB | 5.1 GiB (13.4%) of 38 GiB | 152077 (0.8%) of 19922432 |
    |  pg_global | postgres | $PGDATA = /data/postgres/data | 559 KiB | 5.1 GiB (13.4%) of 38 GiB | 152077 (0.8%) of 19922432 |
    +------------+----------+-------------------------------+---------+---------------------------+---------------------------+

Database #1:
    Name:                postgres
    Owner:               postgres
    Tablespace:          pg_default
    Connections:         1 (no max limit)
    Frozen Xid Age:      67
    Transactions:        2079 (98.0%) commits, 43 (2.0%) rollbacks
    Cache Hits:          99.0%
    Rows Changed:        ins 54.2%, upd 1.5%, del 44.3%
    Total Temp:          0 B in 0 files
    Problems:            0 deadlocks, 0 conflicts
    Totals Since:        6 Aug 2024 2:21:38 PM (1 day ago)
    Size:                7.8 MiB
    Tracked Functions:
      +--------------------+-------+-------------+----------------------+
      |           Function | Calls | Time (self) | Time (self+children) |
      +--------------------+-------+-------------+----------------------+
      | pg_stat_statements |    68 |     7.421ms |              7.421ms |
      +--------------------+-------+-------------+----------------------+

    Installed Extensions:
      +--------------------+---------+------------------------------------------------------------------------+
      |               Name | Version |                                                                Comment |
      +--------------------+---------+------------------------------------------------------------------------+
      | pg_stat_statements |     1.8 | track planning and execution statistics of all SQL statements executed |
      |            plpgsql |     1.0 |                                           PL/pgSQL procedural language |
      +--------------------+---------+------------------------------------------------------------------------+

    Slow Queries:
      +-------+----------+------------+-----------+----------------------------------------------------+
      | Calls | Avg Time | Total Time | Rows/Call |                                              Query |
      +-------+----------+------------+-----------+----------------------------------------------------+
      |    21 |  10.009s |  3m30.192s |         1 |                                select pg_sleep($1) |
      |    23 |     10ms |      246ms |         1 | select archived_count,COALESCE(last_archived_wal,$ |
      |   365 |       0s |      130ms |         1 |      select setting from pg_settings where name=$1 |
      |     1 |    112ms |      112ms |         0 |                             create database testdb |
      |    16 |      6ms |       96ms |         1 |                             select pg_switch_wal() |
      |    16 |      3ms |       53ms |         2 | select locktype,granted,count(*) from pg_locks gro |
      |     6 |      8ms |       52ms |         0 | SELECT now() AS current_time, archived_count AS to |
      |     5 |     10ms |       52ms |         1 | SELECT     archived_count,     last_archived_wal,  |
      |    21 |      1ms |       39ms |         0 | SELECT now() AS current_time,archived_count AS tot |
      |    26 |      1ms |       27ms |         0 |           DROP TABLE IF EXISTS temp_archiver_stats |
      |     2 |     10ms |       21ms |         1 | select archived_count,last_archived_wal,last_faile |
      |     2 |     10ms |       20ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     15ms |       15ms |         0 | SELECT now() AS current_time,          last_archiv |
      |     2 |      7ms |       14ms |         7 | SELECT   current_database() AS db, schemaname, tab |
      |     1 |     11ms |       11ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT     checkpoints_timed,     checkpoints_req, |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT now() AS current_time,          a.last_arch |
      |     1 |     10ms |       10ms |         1 | SELECT  archived_count, last_archived_wal, last_fa |
      |     1 |     10ms |       10ms |         1 | SELECT a.archived_count - t.total_archived AS new_ |
      |     1 |     10ms |       10ms |         1 | SELECT a.archived_count - t.total_archived AS new_ |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT archived_count,     COALESCE(last_archived_ |
      |     1 |     10ms |       10ms |         1 | SELECT      (pg_stat_bgwriter.checkpoints_timed +  |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT a.archived_count - t.total_archived AS new_ |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         1 | SELECT (a.archived_count - t.total_archived) / EXT |
      |     1 |     10ms |       10ms |         0 |                create extension pg_stat_statements |
      |    15 |       0s |        9ms |         7 | SELECT name FROM  (SELECT pg_catalog.lower(name) A |
      |     1 |      7ms |        7ms |         2 | SELECT name, current_database(), COALESCE(default_ |
      |     1 |      7ms |        7ms |         1 |             select distinct(granted) from pg_locks |
      |     1 |      6ms |        6ms |         0 | SELECT     pg_stat_activity.pid,     pg_stat_activ |
      |     2 |      3ms |        6ms |         1 |                    SELECT pg_tablespace_size( $1 ) |
      |     4 |      1ms |        4ms |         2 | SELECT  spcname, pg_get_userbyid(spcowner), COALES |
      |     2 |      2ms |        4ms |         1 |                      SELECT pg_database_size( $1 ) |
      |     1 |      3ms |        3ms |         5 | SELECT COALESCE(D.datname, $1), L.locktype, L.mode |
      |     7 |       0s |        3ms |        40 |  select proname from pg_proc where proname like $1 |
      |     1 |      3ms |        3ms |         0 | -- Register a view on the function for ease of use |
      |    17 |       0s |        3ms |        10 | select  userid::regrole, dbid, calls, min_exec_tim |
      |    17 |       0s |        2ms |        10 | select  userid::regrole, dbid, calls, min_exec_tim |
      |    17 |       0s |        2ms |        10 | select  userid::regrole, dbid, calls, min_exec_tim |
      |    17 |       0s |        2ms |        10 | select  userid::regrole, dbid, calls, min_exec_tim |
      |    10 |       0s |        2ms |         2 | SELECT c2.relname, i.indisprimary, i.indisunique,  |
      |     1 |      2ms |        2ms |         2 |            select distinct(locktype) from pg_locks |
      |    21 |       0s |        1ms |        12 | SELECT a.attname,   pg_catalog.format_type(a.attty |
      |     1 |      1ms |        1ms |         1 | SELECT funcid, schemaname, funcname, current_datab |
      |     1 |      1ms |        1ms |         0 |                     drop table temp_archiver_stats |
      |    11 |       0s |        1ms |         0 | SELECT     pid,     datname,     relid::regclass A |
      |     2 |       0s |        1ms |         6 | SELECT COALESCE(datname, $1), COALESCE(usename, $2 |
      |    24 |       0s |        1ms |         0 | SELECT c.oid,   n.nspname,   c.relname FROM pg_cat |
      |     1 |      1ms |        1ms |         2 | SELECT  spcname, pg_get_userbyid(spcowner), pg_tab |
      |     1 |      1ms |        1ms |         1 |                      select pg_tablespace_size($1) |
      |    26 |       0s |        1ms |         1 | SELECT count(*) AS wal_file_count FROM pg_ls_waldi |
      |     1 |      1ms |        1ms |         4 | SELECT datname,          pg_size_pretty(pg_databas |
      |     1 |      1ms |        1ms |         1 |      select pg_size_pretty(pg_tablespace_size($1)) |
      |     1 |      1ms |        1ms |         0 | CREATE VIEW pg_stat_statements AS   SELECT * FROM  |
      |     1 |      1ms |        1ms |         0 | WITH P AS (SELECT DISTINCT pid FROM pg_locks WHERE |
      |     1 |      1ms |        1ms |         1 | SELECT S.relid, S.schemaname, S.relname, current_d |
      |    10 |       0s |         0s |         1 |              select count(*) from pg_stat_activity |
      |     1 |       0s |         0s |         0 | /* contrib/pg_stat_statements/pg_stat_statements-- |
      |    10 |       0s |         0s |         1 | select count(*) from pg_stat_activity where state= |
      |     8 |       0s |         0s |         1 | select count(*) from pg_stat_activity where wait_e |
      |     9 |       0s |         0s |         1 | select count(*) from pg_stat_activity WHERE xact_s |
      |     2 |       0s |         0s |         0 | SELECT     pid,     usename,     datname,     stat |
      |     1 |       0s |         0s |       347 | SELECT name, setting, COALESCE(boot_val,$1), sourc |
      |    21 |       0s |         0s |         1 | SELECT c.relchecks, c.relkind, c.relhasindex, c.re |
      |    10 |       0s |         0s |         9 | SELECT R.rolname as "Name",  R.rolcanlogin as "Log |
      |     5 |       0s |         0s |         0 | SELECT  (now() - query_start)  as query_time_taken |
      |     5 |       0s |         0s |         9 | SELECT R.oid, R.rolname, R.rolsuper, R.rolinherit, |
      |     1 |       0s |         0s |         1 | SELECT    version(), -- version    EXTRACT($1 FROM |
      |     1 |       0s |         0s |         9 |    SELECT name FROM pg_ls_waldir() WHERE name ~ $1 |
      |     2 |       0s |         0s |         0 |       GRANT SELECT ON pg_stat_statements TO PUBLIC |
      |     2 |       0s |         0s |         3 | SELECT d.datname as "Name",        pg_catalog.pg_g |
      |     1 |       0s |         0s |         2 | SELECT D.oid, D.datname, D.datdba, D.dattablespace |
      |     1 |       0s |         0s |         1 | SELECT COALESCE(datname, $1), COALESCE(usename, $2 |
      |     1 |       0s |         0s |         1 | SELECT n.nspname as "Schema",   c.relname as "Name |
      |     1 |       0s |         0s |         1 | SELECT     pid,     usename,     application_name, |
      |     1 |       0s |         0s |         0 | CREATE FUNCTION pg_stat_statements(IN showtext boo |
      |     2 |       0s |         0s |         3 | SELECT role.rolname AS role_name,        member.ro |
      |     1 |       0s |         0s |         0 | /* Now redefine */ CREATE FUNCTION pg_stat_stateme |
      |    19 |       0s |         0s |         1 |                  select pg_postmaster_start_time() |
      |     1 |       0s |         0s |         0 | SELECT t.relname AS table_name,          i.relname |
      |    15 |       0s |         0s |         1 |                  select * from temp_archiver_stats |
      |     1 |       0s |         0s |         0 | SELECT COALESCE(usename, $1), application_name,    |
      |     1 |       0s |         0s |         0 | /* Then we can drop them */ DROP VIEW pg_stat_stat |
      |     1 |       0s |         0s |         0 |       alter user postgres with password 'postgres' |
      |     1 |       0s |         0s |         0 | /* Now redefine */ CREATE FUNCTION pg_stat_stateme |
      +-------+----------+------------+-----------+----------------------------------------------------+

Database #2:
    Name:                testdb
    Owner:               postgres
    Tablespace:          pg_default
    Connections:         0 (no max limit)
    Frozen Xid Age:      67
    Transactions:        11 (84.6%) commits, 2 (15.4%) rollbacks
    Cache Hits:          91.7%
    Rows Changed:        ins 95.5%, upd 4.5%, del 0.0%
    Total Temp:          0 B in 0 files
    Problems:            0 deadlocks, 0 conflicts
    Totals Since:        7 Aug 2024 2:45:49 PM (19 hours ago)
    Size:                7.6 MiB
    Slow Queries:
      +-------+----------+------------+-----------+----------------------------------------------------+
      | Calls | Avg Time | Total Time | Rows/Call |                                              Query |
      +-------+----------+------------+-----------+----------------------------------------------------+
      |     2 |      2ms |        5ms |         0 | create table t(id int primary key,name varchar(10) |
      |     1 |       0s |         0s |         1 | SELECT n.nspname as "Schema",   c.relname as "Name |
      |     1 |       0s |         0s |         1 | SELECT name FROM  (SELECT pg_catalog.lower(name) A |
      |     1 |       0s |         0s |         1 |                        insert into t values($1,$2) |
      +-------+----------+------------+-----------+----------------------------------------------------+

Table #1 in "postgres":
    Name:                postgres.public.temp_archiver_stats
    Columns:             2
    Manual Vacuums:      never
    Manual Analyze:      never
    Auto Vacuums:        never
    Auto Analyze:        never
    Post-Analyze:        100.0% est. rows modified
    Row Estimate:        100.0% live of total 1
    Rows Changed:        ins 100.0%, upd 0.0%, del 0.0%
    HOT Updates:         0.0% of all updates
    Seq Scans:           1, 1.0 rows/scan
    Idx Scans:           0, 0.0 rows/scan
    Cache Hits:          50.0% (idx=0.0%)
    Size:                8.0 KiB

